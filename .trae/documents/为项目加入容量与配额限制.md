## 目标
- 设置主盘容量上限，达到上限后自动将新上传写入副盘的 `upload` 文件夹。
- 保持前端访问 URL 不变（统一 `/uploads/<type>/<filename>`），由服务路由动态从主/副盘读取。
- 在登录页增加“管理员登录”链接指向 `/admin/login`，并新增该页面。

## 技术实现
### 配置与工具
1. 新增 `src/config/storage.ts`（可读取 `.env`）：
   - `UPLOAD_PRIMARY_ROOT`（默认 `process.cwd()/public/uploads`）
   - `UPLOAD_SECONDARY_ROOT`（例如 `E:/uploads`）
   - `UPLOAD_CAP_PRIMARY_MB`、`UPLOAD_CAP_SECONDARY_MB`
   - `RETENTION_DAYS`（预留）
2. 新增 `src/lib/storage.ts`：
   - `getDirSize(dir: string): Promise<number>` 计算目录占用（MB）。
   - `ensureDir(dir: string)` 保证目录存在。
   - `pickUploadTarget(type: 'works'|'courses'|'honors'|'competitions'|'avatars')`：若主盘未超限→返回主盘目录，超限→返回副盘目录；同时返回规范化的外部访问路径 `/uploads/<type>/<filename>`。

### 服务路由
3. 新增 `src/app/uploads/[...path]/route.ts`：
   - 解析 `<type>/<filename>`，依次尝试在主盘、再副盘定位并以流方式返回文件。
   - 这样无需改动前端 URL，即使文件在副盘也能正常访问。

### 接入上传路由
4. 在以下上传路由保存文件前接入 `pickUploadTarget`（并补充缺失的大小/MIME校验）：
   - `src/app/api/works/upload/route.ts`
   - `src/app/api/courses/upload/route.ts`
   - `src/app/api/competitions/upload/route.ts`
   - `src/app/api/honors/upload/route.ts`
   - `src/app/api/upload/avatar/route.ts`
   - 将 `uploadDir` 替换为 `target.dir`，`fileUrl` 固定为 `/uploads/<type>/<filename>`。

### 管理员登录入口
5. 登录页链接：
   - 在 `src/app/login/page.tsx` 增加跳转 `/admin/login` 的链接按钮（不改变现有登录逻辑）。
6. 管理员登录页：
   - 新增 `src/app/admin/login/page.tsx`，复用 `/api/auth/login`；校验 `role === 'admin'` 后跳转 `/admin`。

## 兼容与安全
- 无数据库模式：沿用现有 JSON 元数据文件；在记录中加入 `storageLocation: 'primary'|'secondary'` 以便后续统计。
- MIME/大小校验在所有上传路由统一实现，避免不受控文件写入。
- Windows 路径处理统一使用 `path.join`，避免分隔符问题。

## 验收
- 设置主盘阈值较小（便于测试），上传至超限后自动写入副盘；访问 `/uploads/...` 均能正常读取。
- 登录页出现管理员登录入口；管理员账号通过 `/admin/login` 登录成功后进入 `/admin`。

## 后续可选增强
- 增加 `/api/admin/storage` 返回主/副盘使用情况与各类型占用；
- 增加清理策略（按 `RETENTION_DAYS` 删除过期文件）。